{"version":3,"sources":["api/get.js"],"names":["getMixmin","resolvePath","p","resolve","__dirname","ROOT_PATH","app","get","req","res","sendFile","post","urlencodedParser","userName","body","password","end","error","insert","result","getByConditions"],"mappings":";;;;;;;;;;kBAewBA,S;;AAfxB;;;;AACA;;;;AACA;;;;AAIA;;;AAGA,SAASC,WAAT,CAAqBC,CAArB,EAAwB;AACpB,WAAO,eAAKC,OAAL,CAAaC,SAAb,EAAwB,QAAxB,EAAkCF,CAAlC,CAAP;AACH;;AAED,IAAMG,YAAYJ,YAAY,IAAZ,CAAlB;;AAEe,SAASD,SAAT,CAAmBM,GAAnB,EAAwB;AACnCA,QAAIC,GAAJ,CAAQ,GAAR,EAAa,UAACC,GAAD,EAAMC,GAAN,EAAc;AACvBA,YAAIC,QAAJ,CAAgBL,SAAhB;AACH,KAFD;;AAIA;;;AAGAC,QAAIK,IAAJ,CAAS,WAAT,EAAsBC,gBAAtB,EAAwC,UAACJ,GAAD,EAAMC,GAAN,EAAc;AAClD,YAAMI,WAAWL,IAAIM,IAAJ,CAASD,QAA1B;AACA,YAAME,WAAWP,IAAIM,IAAJ,CAASC,QAA1B;;AAEA,YAAI,CAACF,QAAD,IAAa,CAACE,QAAlB,EAA4B;AACxBN,gBAAIO,GAAJ,CAAQ,yBAAe;AACnBC,uBAAO;AADY,aAAf,CAAR;AAGH,SAJD,MAIO;AACH,6BAAOC,MAAP,CAAcL,QAAd,EAAwBE,QAAxB,EAAkC,UAACI,MAAD,EAAY;AAC1CV,oBAAIO,GAAJ,CAAQ,yBAAeG,MAAf,CAAR;AACH,aAFD;AAGH;AACJ,KAbD;;AAeAb,QAAIK,IAAJ,CAAS,UAAT,EAAqBC,gBAArB,EAAuC,UAACJ,GAAD,EAAMC,GAAN,EAAc;AACjD,YAAMI,WAAWL,IAAIM,IAAJ,CAASD,QAA1B;;AAEA,YAAI,CAACA,QAAL,EAAe;AACXJ,gBAAIO,GAAJ,CAAQ,yBAAe;AACnBC,uBAAO;AADY,aAAf,CAAR;AAGH,SAJD,MAIO;AACH,6BAAOG,eAAP,CAAuBP,QAAvB,EAAiC,UAACM,MAAD,EAAY;AACzCV,oBAAIO,GAAJ,CAAQ,yBAAeG,MAAf,CAAR;AACH,aAFD;AAGH;AACJ,KAZD;AAaH","file":"get.js","sourcesContent":["import path from 'path';\nimport dbtest from '../db/dbtest';\nimport {\n    log,\n} from '../util/debug';\n\n/**\n * 定义一些get请求的API\n */\nfunction resolvePath(p) {\n    return path.resolve(__dirname, '../../', p);\n}\n\nconst ROOT_PATH = resolvePath('./');\n\nexport default function getMixmin(app) {\n    app.get('/', (req, res) => {\n        res.sendFile(`${ROOT_PATH}/pages/index.html`);\n    });\n    \n    /**\n     * \n     */\n    app.post('/savedata', urlencodedParser, (req, res) => {\n        const userName = req.body.userName;\n        const password = req.body.password;\n        \n        if (!userName || !password) {\n            res.end(JSON.stringify({\n                error: '参数格式错误',\n            }));\n        } else {\n            dbtest.insert(userName, password, (result) => {\n                res.end(JSON.stringify(result));\n            });\n        }\n    });\n    \n    app.post('/getdata', urlencodedParser, (req, res) => {\n        const userName = req.body.userName;\n        \n        if (!userName) {\n            res.end(JSON.stringify({\n                error: '参数格式错误',\n            }));\n        } else {\n            dbtest.getByConditions(userName, (result) => {\n                res.end(JSON.stringify(result));\n            });\n        }\n    });\n}"]}