{"version":3,"sources":["api/testdb.js"],"names":["testdbMixmin","urlencodedParser","urlencoded","extended","app","post","req","res","userName","body","password","end","error","data","get","query"],"mappings":";;;;;;;;;;;;;;kBAcwBA,Y;;AAdxB;;;;AACA;;AAGA;;;;AAKA;AACA,MAAMC,mBAAmB,qBAAWC,UAAX,CAAsB;AAC3CC,cAAU;AADiC,CAAtB,CAAzB;;AAIe,SAASH,YAAT,CAAsBI,GAAtB,EAA2B;AACtCA,QAAIC,IAAJ,CAAS,WAAT,EAAsBJ,gBAAtB,EAAwC,CAACK,GAAD,EAAMC,GAAN,KAAc;AAClD,cAAMC,WAAWF,IAAIG,IAAJ,CAASD,QAA1B;AACA,cAAME,WAAWJ,IAAIG,IAAJ,CAASC,QAA1B;;AAEA,wBAAK,iBAAgBF,QAAS,YAAWE,QAAS,EAAlD;AACA,YAAI,CAACF,QAAD,IAAa,CAACE,QAAlB,EAA4B;AACxBH,gBAAII,GAAJ,CAAQ,yBAAe;AACnBC,uBAAO;AADY,aAAf,CAAR;;AAIA;AACH;AACD,wCAAC,aAAY;AACT,kBAAMC,OAAO,MAAM,oBAAOL,QAAP,EAAiBE,QAAjB,CAAnB;;AAEA,4BAAIG,IAAJ;;AAEAN,gBAAII,GAAJ,CAAQ,yBAAeE,IAAf,CAAR;AACH,SAND;AAOH,KAnBD;;AAqBAT,QAAIU,GAAJ,CAAQ,UAAR,EAAoB,CAACR,GAAD,EAAMC,GAAN,KAAc;AAC9B,cAAMC,WAAWF,IAAIS,KAAJ,CAAUP,QAA3B;;AAEA,YAAI,CAACA,QAAL,EAAe;AACXD,gBAAII,GAAJ,CAAQ,yBAAe;AACnBC,uBAAO;AADY,aAAf,CAAR;;AAIA;AACH;AACD,wCAAC,aAAY;AACT,kBAAMC,OAAO,MAAM,6BAAgBL,QAAhB,CAAnB;;AAEA,4BAAIK,IAAJ;;AAEAN,gBAAII,GAAJ,CAAQ,yBAAeE,IAAf,CAAR;AACH,SAND;AAOH,KAjBD;AAkBH","file":"testdb.js","sourcesContent":["import bodyParser from 'body-parser';\nimport {\n    log,\n} from '../util/debug';\nimport {\n    insert,\n    getByConditions,\n} from '../db/dbtest';\n\n// 创建 application/x-www-form-urlencoded 编码解析\nconst urlencodedParser = bodyParser.urlencoded({\n    extended: false,\n});\n\nexport default function testdbMixmin(app) {\n    app.post('/savedata', urlencodedParser, (req, res) => {\n        const userName = req.body.userName;\n        const password = req.body.password;\n        \n        log(`save:userName:${userName},password${password}`);\n        if (!userName || !password) {\n            res.end(JSON.stringify({\n                error: '参数格式错误',\n            }));\n            \n            return;\n        }\n        (async () => {\n            const data = await insert(userName, password);\n            \n            log(data);\n            \n            res.end(JSON.stringify(data));\n        })();\n    });\n    \n    app.get('/getdata', (req, res) => {\n        const userName = req.query.userName;\n        \n        if (!userName) {\n            res.end(JSON.stringify({\n                error: '参数格式错误',\n            }));\n            \n            return;\n        }\n        (async () => {\n            const data = await getByConditions(userName);\n            \n            log(data);\n            \n            res.end(JSON.stringify(data));\n        })();\n    });\n}"]}